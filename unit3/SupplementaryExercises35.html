

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Supplementary Exercises* &#8212; ISYE 6420 - BUGS to PyMC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'unit3/SupplementaryExercises35';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Probability Distributions" href="../unit4/distributions.html" />
    <link rel="prev" title="Supplementary Problem: Emily’s Vacation*" href="Unit3-Emily.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo2.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo2.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-about-this-course.html">1. About This Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-topics.html">2. Topics Covered</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-software.html">3. Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-simple-regression.html">4. A Simple Regression*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-history.html">1. History of Bayesian Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-history2.html">2. Historic Overview Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-bayesianvsclassical.html">3. Bayesian vs. Frequentist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-10flips.html">4. Ten Coin Flips*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-fda.html">5. FDA Recommendations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 3</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Unit3-NecessaryProbability.html">1. A Review of Necessary Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-conditioning1.html">2. Conditioning, Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-conditioning2.html">3. Conditioning, Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-Bayes-theorem.html">4. Bayes’ Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-ManufacturingBayes.html">5. Manufacturing Bayes*</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-TwoHeadedCoin.html">6. Two-headed Coin*</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-bayesnetworks.html">7. Bayes Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Unit3-Alarm.html">8. Alarm*</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="moreexamples3.html">More Examples</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Unit3-Emily.html">Supplementary Problem: Emily’s Vacation*</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Supplementary Exercises*</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/distributions.html">Probability Distributions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-basicdist.html">1. Basic Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-numericalchar.html">2. Numerical Characteristics of Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-jointconditionals.html">3. Joint and Conditional Distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/bayestheorem.html">Bayes’ Theorem</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-ingredients.html">4. Ingredients for Bayesian Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-conjugatefamilies.html">5. Conjugate Families</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-IQexample.html">6. Example: Jeremy’s IQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-BetaPriors.html">7. Ten Coin Flips Revisited: Beta Plots*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-poissongamma.html">8. Poisson–Gamma Model</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/conjugatecases.html">Bayesian Inference in Conjugate Cases</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-estimation.html">9. Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-crediblesets.html">10. Credible Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-GammaGamma.html">11. Gamma Gamma*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-testing.html">12. Bayesian Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-prediction.html">13. Prediction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/priors.html">Priors</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-elicitation.html">14. Prior Elicitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-noninform.html">15. Non-informative Priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-samplesize.html">16. Prior Sample Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-eBay.html">17. eBay Purchase Example*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/empiricalbayes.html">Empirical Bayes</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-parametric.html">18. Parametric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-nonpara.html">19. Non-parametric</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/moreexamples.html">More Examples</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-AlphaParticles.html">Counts of Alpha Particles*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/SupplementaryExercises43.html">Supplementary Exercises 4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/SupplementaryExercises48.html">Supplementary Exercises 4.8</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/bayesian-computation.html">Bayesian Computation</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-numericalapproaches.html">1. Numerical Approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-norcau1.html">2. Normal–Cauchy Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Laplace.html">3. Laplace’s Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-demo-Laplaces-method.html">4. Laplace’s Method Demo*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-mcmc.html">5. Markov Chain Monte Carlo</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/metropolis-hastings.html">The Metropolis Algorithm</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Metropolis.html">6. Metropolis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Metropolis1.html">7. Metropolis: Normal-Cauchy*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-MetropolisHastings.html">8. Metropolis–Hastings: Weibull-Exponential Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-MetropolisHastings2.html">9. Weibull Lifetimes*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/gibbs-sampling.html">Gibbs Sampling</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbsintro.html">10. Introduction to Gibbs Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-GibbsSampler.html">11. Normal-Cauchy Gibbs Sampler*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbs2.html">12. Conjugate Gamma-Poisson Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-PumpsMCMC.html">13. Pumps*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbsex3math.html">14. Change Point Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Gibbs3.html">15. Coal Mining Disasters in the UK*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/other.html">Other Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-hamiltonian.html">16. Hamiltonian Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-other-methods.html">17. Going Further</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../unit5/SupplementaryExercises54.html">Supplementary Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-probabilisticprogramming.html">1. Probabilistic Programming Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-doodlebug.html">2. Creating a Graphical Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-demo-doodle.html">3. Joint Probability Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-moreaboutpymc.html">4. More About PyMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-loadingdata.html">5. Loading Data, Step Function, and Deterministic Variables*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-missingdata.html">6. Missing Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-htesting.html">7. Hypothesis Testing*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-prediction.html">8. Prediction*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-censoring.html">9. Type-1 Censoring*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-customlikelihood.html">10. The Zero Trick and Custom Likelihoods*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit7/hierarchical.html">Hierarchical Models</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-introduction.html">1. Introduction to Hierarchical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-why.html">2. Reasons to Use Hierarchical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-priors.html">3. Priors with Structural Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-hiddenmixtures.html">4. Priors as Hidden Mixtures*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-metaanalysis.html">5. Meta-analysis via Hierarchical Models*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit7/linearmodels.html">Linear Models</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-anova.html">6. Analysis of Variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-coagulation.html">7. Coagulation*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-factorial.html">8. Factorial Designs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-demo-factorial.html">9. Simvastatin*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-regression.html">10. Simple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-demo-regression.html">11. Brozek index prediction*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-multipleregression.html">12. Multiple Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-demo-multiple.html">13. Multiple Regression: Brozek Index Prediction*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit7/othermodels.html">Other Models</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-other.html">14. Generalized Linear Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-arrhythmia.html">15. GLM Examples*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-multinomial.html">16. Multinomial Logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-demo-multinomial.html">17. Multinomial regression*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-multilevel.html">18. Multilevel Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit7/Unit7-demo-multilevel.html">19. Paraguay Vaccination Status*</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../unit7/SupplementaryExercises74.html">Supplementary Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-missing.html">1. Missing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-missrats.html">2. Rats Example with Missing Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-timetoevent.html">3. Time-to-event Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tteex1.html">4. Time-to-event Models: Example 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tteex2.html">5. Time-to-event Models: Example 2*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tte-gastric.html">6. Time-to-event Models: Gastric Cancer*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/SupplementaryExercises83.html">Supplementary Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-fit-selection-diagnostics.html">1. Model Fit, Selection, and Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-dic.html">2. Deviance Information Criterion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-fitsel.html">3. Model Fit and Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-hald.html">4. Hald*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cpo.html">5. Conditional Predictive Ordinate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-gessell.html">6. Gesell*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cumulative.html">7. Using the Empirical CDF and the Probability Integral Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cumulative2.html">8. Cumulative Example*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-ssvs.html">9. Stochastic Search Variable Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-hald2.html">10. SSVS: Hald*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/SupplementaryExercises93.html">Supplementary Exercises</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-lister.html">1. Lister*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-growth.html">2. Dental Development*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-disasters.html">3. Revisiting UK Coal Mining Disasters*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-rasch.html">4. Rasch*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-italywines123.html">5. Wine Classification*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-katla.html">6. Predicting Using Censored Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-sunspots.html">7. Prediction of Time Series*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../backmatter/bibliography.html">1. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backmatter/latex_reference.html">2. Latex Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/areding/6420-pymc/blob/main/unit3/SupplementaryExercises35.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/areding/6420-pymc" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/areding/6420-pymc/issues/new?title=Issue%20on%20page%20%2Funit3/SupplementaryExercises35.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/unit3/SupplementaryExercises35.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Supplementary Exercises*</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-neighbors">1. New neighbors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-neighbors-with-three-children">2. New neighbors with three children</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#queen-of-spades-revisited">3. Queen of spades revisited</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-choice">4. Multiple Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifier">5. Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alzheimers">6. Alzheimer’s</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mysterious-transfer">7. Mysterious Transfer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nir-and-raman-in-parkinsons">8. NIR and Raman in Parkinson’s</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#twins">9. Twins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hexi">10. Hexi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-dice-at-the-casino">11. Playing Dice at the Casino</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#redundant-wiring">12. Redundant Wiring</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-linked-system">13. Cross-linked System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sprinkler-bayes-net">14. Sprinkler Bayes Net</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-diagnostic-bayes-network">15. Simple Diagnostic Bayes Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-alarm">16. Smart Alarm</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="supplementary-exercises">
<h1>Supplementary Exercises*<a class="headerlink" href="#supplementary-exercises" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This page contains solutions! We recommend attempting each problem before peeking.</p>
</div>
<section id="new-neighbors">
<h2>1. New neighbors<a class="headerlink" href="#new-neighbors" title="Permalink to this headline">#</a></h2>
<p>A family with two primary-school children just moved in next door. You have not seen the children yet. Consider two scenarios:</p>
<ol class="arabic simple">
<li><p>This morning you introduced yourself to the neighbor and asked whether he has any boys. He said: Yes. What is the probability that one child is a girl, assuming he is telling the truth?</p></li>
<li><p>This morning you saw one of the children, a boy. What is the probability that one child is a girl?</p></li>
</ol>
<p>In other words, you are either told that there is a boy in family (1) or you saw that there is a boy (2). Why then do the probabilities in (1) and (2) differ? Assume that the probability of a boy or a girl is <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>, and that the genders of the two children are independent.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>These questions are attempting to teach something fundamental about probability. The procedure itself isn’t difficult, but can be very unintuitive, so don’t be worried if it takes time to understand fully.</p>
<p>Our full sample space is <span class="math notranslate nohighlight">\(S = BB, BG, GB, GG\)</span>. All four outcomes are equally likely.</p>
<ol class="arabic simple">
<li><p>You were told that there is a boy among children which excludes the outcome <span class="math notranslate nohighlight">\(GG\)</span>. Now the sample space becomes <span class="math notranslate nohighlight">\(S = BB, BG, GB\)</span> and 2 out of 3 are include <span class="math notranslate nohighlight">\(G\)</span>. The probability is <span class="math notranslate nohighlight">\(\frac{2}{3}\)</span>.</p></li>
<li><p>If a boy is seen, then the event ‘one girl in the family’ is equivalent to the event that the child that we did not see was a girl. The sample space is then reduced to <span class="math notranslate nohighlight">\(S = BB, BG\)</span>. This probability is <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>.</p></li>
</ol>
<p>Why the difference? In scenario 2, the information is the result of a random outcome. In scenario 1, the information obtained is not the result of a random outcome. Except for eliminating the outcome <span class="math notranslate nohighlight">\(GG\)</span>, the neighbor’s statement does not provide any information about the remaining outcomes. The principle of insufficient reason prescribes that if there is no reason to think that one of the three remaining elementary outcomes <span class="math notranslate nohighlight">\(BB\)</span>, <span class="math notranslate nohighlight">\(BG\)</span>, or <span class="math notranslate nohighlight">\(GB\)</span> is more probable than another, then one should assign equal probability to each.</p>
<p>What does the sample space order describe here? It isn’t about which child is older—it’s about the order you see them in. It is a reflection of the state of our knowledge and precisely how different pieces of evidence affect that state.</p>
<p>A similar unintuitive result is the famous <a class="reference external" href="https://en.wikipedia.org/wiki/Monty_Hall_problem">Monty Hall problem</a>, where switching doors improves the probability of a win.</p>
</div>
</section>
<section id="new-neighbors-with-three-children">
<h2>2. New neighbors with three children<a class="headerlink" href="#new-neighbors-with-three-children" title="Permalink to this headline">#</a></h2>
<p>You just got new neighbors, a family with three elementary school children. You have not seen the children yet. Consider two scenarios:</p>
<ol class="arabic simple">
<li><p>This morning you met the neighbor and asked whether he has any boys. He answers: Yes. What is the probability that exactly one child is a girl, assuming your neighbor is telling the truth?</p></li>
<li><p>This morning you saw one of the children, a boy. What is the probability that exactly one child is a girl?</p></li>
</ol>
<p>In other words, you are either told that there is a boy in family (1) or you saw that there is a boy (2). Why then do the probabilities in (1) and (2) differ? Find the probabilities and explain. Assume that the probability of a boy or a girl is <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>, and that the genders of the three children are independent.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Original sample space (length 8):</p>
<div class="math notranslate nohighlight">
\[S = BBB, BBG, BGB, BGG, GBB, GBG, GGB, GGG\]</div>
<p>Here is a branching diagram:</p>
<p><img alt="branching diagram 1" src="../_images/35q2branch1.jpg" /></p>
<p>New information in scenario 1 reduces S to a length of 7:</p>
<div class="math notranslate nohighlight">
\[S = BBB, BBG, BGB, BGG, GBB, GBG, GGB\]</div>
<p><img alt="branching diagram 2" src="../_images/35q2branch2.jpg" /></p>
<p><span class="math notranslate nohighlight">\(3/7\)</span> have exactly one G.</p>
<p>In scenario 2, the length of S reduces to 4:</p>
<div class="math notranslate nohighlight">
\[S = BBB, BBG, BGB, BGG\]</div>
<p><img alt="branching diagram 3" src="../_images/35q2branch3.jpg" /></p>
<p><span class="math notranslate nohighlight">\(2/4\)</span> have exactly one G.</p>
<p>The answers would change if we were wondering about the probability of there being at least one girl, to <span class="math notranslate nohighlight">\(6/7\)</span> and <span class="math notranslate nohighlight">\(3/4\)</span>.</p>
<p>The key to thinking about these problems is in understandting the difference between the types of information received. If you see a boy after being told that there’s at least one boy, that tells you what, exactly? What additional information have you gained? The next child you see will still either be a boy or a girl, but now you know which one you’ve seen first.</p>
</div>
</section>
<section id="queen-of-spades-revisited">
<h2>3. Queen of spades revisited<a class="headerlink" href="#queen-of-spades-revisited" title="Permalink to this headline">#</a></h2>
<p>From the standard deck of 52 cards, the 2 of diamonds, 3 of spades, 4 of clubs, and 5 of hearts are removed. From the remaining cards, one card is selected at random.</p>
<ol class="arabic simple">
<li><p>Are the events A - the selected card is queen, and B - the selected card is a spade, independent?</p></li>
<li><p>What is the answer to (a) if from the standard deck both red suits are eliminated, and prior to selecting a card, the deck contains only spades and clubs suits?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>Events <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are independent since <span class="math notranslate nohighlight">\(\frac{1}{48} = P(A \cap B) = P(A) \cdot P(B) = \frac{4}{48} \cdot \frac{12}{48}\)</span>.</p></li>
<li><p>Independent, for <span class="math notranslate nohighlight">\(\frac{1}{26} = \frac{2}{26} \cdot \frac{13}{26}\)</span>.</p></li>
</ol>
<p>If there are an equal number of cards left in the deck from each suit, any given suit has the same probability of drawing a queen.</p>
<p>In this case, if you drew a spade, heart, or club, the probability that your card is a queen will be different than the probability of a queen given that you drew a diamond. You have slightly more information about the diamonds since there are only 12 remaining in the deck (the denominator is different).</p>
<p>So now depending on the suit a queen might be more likely. In other words, the probability of a queen is no longer independent of the suit.</p>
<p>See <a class="reference external" href="https://areding.github.io/6420-pymc/unit3/Unit3-conditioning1.html#the-queen-of-spades">Unit 3, Lesson 2.</a></p>
</div>
</section>
<section id="multiple-choice">
<h2>4. Multiple Choice<a class="headerlink" href="#multiple-choice" title="Permalink to this headline">#</a></h2>
<p>A student answers a multiple choice examination question that has 4 possible answers. Suppose that the probability that the student knows the answer to a question is 0.80 and the probability that the student guesses is 0.20. If the student guesses, the student is able to eliminate two choices as wrong and guess on the remaining two choices in 40% of cases. In this case, the probability of a correct answer is <span class="math notranslate nohighlight">\(\frac{1}{2}\)</span>. The student is able to eliminate one choice as wrong and guess on the remaining three choices in 30% of cases, and for 30% of questions, the student is not able to eliminate any choice and the probability of a correct answer is <span class="math notranslate nohighlight">\(\frac{1}{4}\)</span>.</p>
<ol class="arabic simple">
<li><p>What is the probability that the randomly selected question is answered correctly?</p></li>
<li><p>If it is answered correctly, what is the probability that the student really knew the correct answer?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Let <span class="math notranslate nohighlight">\(H_1\)</span> be the hypothesis that the student knows the question, <span class="math notranslate nohighlight">\(H_2\)</span> is the event that the student guesses and was able to eliminate correctly two choices as wrong, <span class="math notranslate nohighlight">\(H_3\)</span> is the event that the student guesses and eliminates correctly one choice as wrong, and <span class="math notranslate nohighlight">\(H_4\)</span> is the event that student guesses and is not able to eliminate any of the choices as wrong. It is given that <span class="math notranslate nohighlight">\(P(H_1) = 0.8\)</span>, <span class="math notranslate nohighlight">\(P(H_2) = 0.2 \cdot 0.4 = 0.08\)</span>, <span class="math notranslate nohighlight">\(P(H_3) = 0.2 \cdot 0.3 = 0.06\)</span>, and <span class="math notranslate nohighlight">\(P(H_4) = 0.2 \cdot 0.3 = 0.06\)</span>.</p>
<p>Denote by <span class="math notranslate nohighlight">\(A\)</span> the event that the student answers the question correctly. Then, <span class="math notranslate nohighlight">\(P(A | H_1) = 1\)</span>, <span class="math notranslate nohighlight">\(P(A | H_2) = \frac{1}{2}\)</span>, <span class="math notranslate nohighlight">\(P(A | H_3) = \frac{1}{3}\)</span>, and <span class="math notranslate nohighlight">\(P(A | H_4) = \frac{1}{4}\)</span>. Using the rule of total probability, the required probability in (A) is</p>
<div class="math notranslate nohighlight">
\[
P(A) = P(A | H_1)P(H_1) + P(A | H_2)P(H_2) + P(A | H_3)P(H_3) + P(A | H_4)P(H_4) = 1 \cdot 0.8 + 0.08 \cdot \frac{1}{2} + 0.06 \cdot \frac{1}{3} + 0.06 \cdot \frac{1}{4} = 0.875.
\]</div>
<p>In (B) we are interested in <span class="math notranslate nohighlight">\(P(H_1 | A)\)</span> and this can be found using Bayes’ rule.</p>
<div class="math notranslate nohighlight">
\[
P(H_1 | A) = \frac{P(A | H_1)P(H_1)}{P(A)} = \frac{0.8}{0.875} = 0.9143
\]</div>
</div>
</section>
<section id="classifier">
<h2>5. Classifier<a class="headerlink" href="#classifier" title="Permalink to this headline">#</a></h2>
<p>In a machine learning classification procedure, the items are classified as 1 or 0. Based on a training sample of size 120 in which there are 65 1’s and 55 0’s, the classifier predicts 70 1’s and 50 0’s. Out of 70 items predicted by the classifier as 1, 52 are correctly classified.</p>
<ol class="arabic simple">
<li><p>What are the sensitivity and specificity of the classifier?</p></li>
<li><p>From the population of items where the proportion of 0-labels is 95% (and 1-labels 5%), an item is selected at random. What is the probability that the item is of label 1 if the classifier says it was?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Based on the problem statement, we have the following information. By the law of Total Probability and Bayes’ rule, we have:</p>
<div class="math notranslate nohighlight">
\[
P(\text{item} = 1 \mid \text{cls} = 1) = \frac{P(\text{cls} = 1 \mid \text{item} = 1)P(\text{item} = 1)}{P(\text{cls} = 1)} 
\]</div>
<div class="math notranslate nohighlight">
\[
= \frac{P(\text{cls} = 1 \mid \text{item} = 1)P(\text{item} = 1)}{P(\text{cls} = 1 \mid \text{item} = 1)P(\text{item} = 1) + P(\text{cls} = 1 \mid \text{item} = 0)P(\text{item} = 0)} 
\]</div>
<div class="math notranslate nohighlight">
\[
= \frac{\left(\frac{52}{65}\right)(0.05)}{\left(\frac{52}{65}\right)(0.05) + \left(\frac{18}{55}\right)(0.95)} = 0.113989637 
\]</div>
<p>Here, the sensitivity of the classifier is <span class="math notranslate nohighlight">\(\frac{52}{65} = 0.8\)</span> and the specificity is <span class="math notranslate nohighlight">\(\frac{37}{55} \approx 0.67272\)</span>. Since the prevalence of 1’s is only 5%, the positive predicted value, that is <span class="math notranslate nohighlight">\(P(\text{item} = 1 \mid \text{cls} = 1)\)</span>, is only <span class="math notranslate nohighlight">\(11.4\%\)</span>. This is the source of the “prosecutor’s paradox”.</p>
</div>
</section>
<section id="alzheimers">
<h2>6. Alzheimer’s<a class="headerlink" href="#alzheimers" title="Permalink to this headline">#</a></h2>
<p>A medical research team wished to evaluate a proposed screening test for Alzheimer’s disease. The test was given to a random sample of 450 patients with Alzheimer’s disease and to an independent sample of 500 subjects without symptoms of the disease. The two samples were drawn from the population of subjects who are 65 years old or older. The results are as follows:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Test Result</p></th>
<th class="head"><p>Diagnosed Alzheimer’s, <span class="math notranslate nohighlight">\(D\)</span></p></th>
<th class="head"><p>No Alzheimer’s Symptoms, <span class="math notranslate nohighlight">\(D^c\)</span></p></th>
<th class="head"><p>Total</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Positive Test, T</p></td>
<td><p>436</p></td>
<td><p>5</p></td>
<td><p>441</p></td>
</tr>
<tr class="row-odd"><td><p>Negative Test, <span class="math notranslate nohighlight">\(T^c\)</span></p></td>
<td><p>14</p></td>
<td><p>495</p></td>
<td><p>509</p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p>450</p></td>
<td><p>500</p></td>
<td><p>950</p></td>
</tr>
</tbody>
</table>
<p>Probability of D (prevalence) is the rate of the disease in the relevant population (<span class="math notranslate nohighlight">\(\ge 65\)</span>
y.o.) and it is estimated to be 11.3 (<span id="id1">Evans and others [<a class="reference internal" href="../backmatter/bibliography.html#id54" title="David A. Evans and others. Estimated prevalence of alzheimer’s disease in the united states. Milbank Quarterly, 68:267-289, 1990.">1990</a>]</span>).</p>
<ol class="arabic simple">
<li><p>Using the numbers from the table, estimate <span class="math notranslate nohighlight">\(P(T | D)\)</span> and <span class="math notranslate nohighlight">\(P(T^c | D^c)\)</span>. Interpret these probabilities in terms of the problem, one sentence for each.</p></li>
<li><p>Find <span class="math notranslate nohighlight">\(P(D | T)\)</span> (positive predicted value) using Bayes’ formula. You cannot find <span class="math notranslate nohighlight">\(P(D | T)\)</span> using information from the table only - you need external info, such as prevalence.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p><span class="math notranslate nohighlight">\(P(T | D) = \frac{436}{450} = 0.9689\)</span>
<span class="math notranslate nohighlight">\(P(T^c | D^c) = \frac{495}{500} = 0.99\)</span></p>
<p><span class="math notranslate nohighlight">\(P(T | D)\)</span> is the probability that a patient who shows symptoms of Alzheimer’s disease would test positive. This is known as the test’s sensitivity.
<span class="math notranslate nohighlight">\(P(T^c | D^c)\)</span> is the probability that a subject who does not have symptoms of Alzheimer’s would test negative. This is known as the test’s specificity.</p>
<p><span class="math notranslate nohighlight">\(P(T^c | D) = 1 - P(T | D) = 0.0311\)</span>
<span class="math notranslate nohighlight">\(P(T | D^c) = 1 - P(T^c | D^c) = 0.01\)</span></p>
<p>To find <span class="math notranslate nohighlight">\(P(D | T)\)</span>, which is the positive predictive value, we use:</p>
<div class="math notranslate nohighlight">
\[
P(D | T) = \frac{P(T | D)P(D)}{P(T)}
\]</div>
<p>Expanding <span class="math notranslate nohighlight">\(P(T)\)</span> using the law of total probability:</p>
<div class="math notranslate nohighlight">
\[
P(T) = P(T | D)P(D) + P(T | D^c)P(D^c)
\]</div>
<p>Substituting the values:</p>
<div class="math notranslate nohighlight">
\[
P(D | T) = \frac{0.9689 \times 0.113}{0.9689 \times 0.113 + 0.01 \times 0.887} = 0.9251
\]</div>
<p><span class="math notranslate nohighlight">\(P(D | T) = 0.9251\)</span> indicates the probability that a patient who tests positive actually has Alzheimer’s disease.</p>
</div>
</section>
<section id="mysterious-transfer">
<h2>7. Mysterious Transfer<a class="headerlink" href="#mysterious-transfer" title="Permalink to this headline">#</a></h2>
<p>Of two bags, one contains four white balls and three black balls and the other contains three white balls and five black balls. One ball is randomly selected from the first bag and placed unseen in the second bag.</p>
<ol class="arabic simple">
<li><p>What is the probability that a ball now drawn from the second bag will be black?</p></li>
<li><p>If the second ball is black, what is the probability that a black ball was transferred?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The solution requires using the rule of total probability, where the event of interest is <span class="math notranslate nohighlight">\(A\)</span> - a ball drawn from the second box is black, and the hypotheses are <span class="math notranslate nohighlight">\(H_1\)</span> - transferred ball is white and <span class="math notranslate nohighlight">\(H_2\)</span> - transferred ball is black. By accounting for the content of the first box, we find <span class="math notranslate nohighlight">\(P(H_1) = \frac{4}{7}\)</span>and <span class="math notranslate nohighlight">\(P(H_2) = \frac{3}{7}\)</span>. The probability <span class="math notranslate nohighlight">\(P(A | H_1) = \frac{5}{9}\)</span> since after the transfer there are 4 white and 5 black balls in the second box. Similarly, <span class="math notranslate nohighlight">\(P(A | H_2) = \frac{6}{9}\)</span>.</p>
<ol class="arabic simple">
<li><p>The probability of selecting a black ball from the second box is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(A) = P(A | H_1)P(H_1) + P(A | H_2)P(H_2) = \frac{5}{9} \times \frac{4}{7} + \frac{6}{9} \times \frac{3}{7} = \frac{38}{63}
\]</div>
<ol class="arabic simple" start="2">
<li><p>By Bayes’ rule:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(H_2 | A) = \frac{P(A | H_2)P(H_2)}{P(A)} = \frac{18/63}{38/63} = \frac{9}{19}
\]</div>
</div>
</section>
<section id="nir-and-raman-in-parkinsons">
<h2>8. NIR and Raman in Parkinson’s<a class="headerlink" href="#nir-and-raman-in-parkinsons" title="Permalink to this headline">#</a></h2>
<p>In a study by Schipper et al. (2008), 53 subjects, 21 with mild or moderate stages of Parkinson’s disease and 32 age-matched controls, had whole blood samples analyzed using the near-infrared (NIR) spectroscopy and Raman spectroscopy methods. The data showed that the two independent biospectroscopy measurement techniques yielded similar and consistent results. In differentiating Parkinson’s disease patients from the control group, Raman spectroscopy resulted in eight false positives and four false negatives. NIR spectroscopy resulted in four false positives and five false negatives.</p>
<p>For both methods, find the Positive Predicted Value, that is, the probability that a person who tested positive and was randomly selected from the same age group in the general population has the disease if no other clinical information is available. Use the assumption that the population prevalence is well estimated by the information in the table (see <span id="id2">Vidakovic [<a class="reference internal" href="../backmatter/bibliography.html#id10" title="Brani Vidakovic. Engineering Biostatistics: An Introduction using MATLAB and WinBUGS. Wiley, 2017. ISBN 978-1-119-16896-6.">2017</a>]</span> p. 137).</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>There are 21 true Parkinson’s patients and there are 32 people as control (without Parkinson’s). We are told that for Raman spectroscopy, there are 8 FP and 4 FN. Using this info we create the following confusion matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|p{4cm}|p{2.5cm}|p{2.5cm}|p{2.5cm}|}
\hline
\text{Raman Result} &amp; \text{Predicted: Disease} &amp; \text{Predicted: No Disease} &amp; \text{Total} \\
\hline
\text{Actual: Disease} &amp; 17 &amp; 4 &amp; 21 \\
\hline
\text{Actual: No Disease} &amp; 8 &amp; 24 &amp; 32 \\
\hline
\text{Total} &amp; 25 &amp; 28 &amp; 53 \\
\hline
\end{array}
\end{split}\]</div>
<p>The Positive Predictive Value (PPV = <span class="math notranslate nohighlight">\(\frac{TP}{TP + FP}\)</span>) is <span class="math notranslate nohighlight">\(\frac{17}{25}\)</span>.</p>
<p>For NIR spectroscopy, we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|p{4cm}|p{2.5cm}|p{2.5cm}|p{2.5cm}|}
\hline
\text{NIR Result} &amp; \text{Predicted: Disease} &amp; \text{Predicted: No Disease} &amp; \text{Total} \\
\hline
\text{Actual: Disease} &amp; 16 &amp; 5 &amp; 21 \\
\hline
\text{Actual: No Disease} &amp; 4 &amp; 28 &amp; 32 \\
\hline
\text{Total} &amp; 20 &amp; 33 &amp; 53 \\
\hline
\end{array}
\end{split}\]</div>
<p>The Positive Predictive Value (PPV = <span class="math notranslate nohighlight">\(\frac{TP}{TP + FP}\)</span>) is then <span class="math notranslate nohighlight">\(\frac{16}{20}\)</span>.</p>
</div>
</section>
<section id="twins">
<h2>9. Twins<a class="headerlink" href="#twins" title="Permalink to this headline">#</a></h2>
<p>Dizygotic (fraternal) twins have the same probability of each gender as in overall births, which is approximately 51% male, 49% female. Monozygotic (identical) twins must be of the same gender. Among all twin pregnancies, about 1/3 are monozygotic. Find the probability of two girls in</p>
<ol class="arabic simple">
<li><p>Monozygotic pregnancy (assuming that monozygotic twins have the same probability of each gender as in overall births).</p></li>
<li><p>Dizygotic pregnancy.</p></li>
<li><p>Dizygotic pregnancy given that we know that the gender of the babies is the same.</p></li>
<li><p>Probability of dizygotic pregnancy given that we know that the gender of the babies is the same.</p></li>
</ol>
<p>If Mary is expecting twins, but no information about the type of pregnancy is available, what is the probability that the babies are</p>
<ol class="arabic simple" start="5">
<li><p>Two girls.</p></li>
<li><p>Of the same gender.</p></li>
<li><p>Find the probability that Mary’s pregnancy is dizygotic if it is known that the babies are two girls. Retain four decimal places in your calculations.</p></li>
</ol>
<p>Hints: (2) genders are independent; (3) since <span class="math notranslate nohighlight">\(A\)</span> is a subset of <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(A \cap B = A\)</span> and <span class="math notranslate nohighlight">\(P(A | B) = P(A)/P(B)\)</span>; (4, 5) total probability; (6) Bayes’ rule.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>0.49</p></li>
<li><p><span class="math notranslate nohighlight">\(0.49^2 = 0.2401\)</span></p></li>
<li><p>Let <span class="math notranslate nohighlight">\(S\)</span> be the event that the sex is the same, and <span class="math notranslate nohighlight">\(D\)</span> the event of dizygotic pregnancy. <span class="math notranslate nohighlight">\(P(GG | S, D) = \frac{P(GG \cap S | D)}{P(S | D)} = \frac{P(GG | D)}{P(S | D)} = \frac{0.49^2}{0.49^2 + 0.51^2} = 0.48\)</span></p></li>
<li><p>This is Bayes’ formula. <span class="math notranslate nohighlight">\(S\)</span> — same gender, hypotheses <span class="math notranslate nohighlight">\(H_1\)</span> — monozygotic, <span class="math notranslate nohighlight">\(H_2\)</span> — dizygotic <span class="math notranslate nohighlight">\(P(H_1) = \frac{1}{3}\)</span>, <span class="math notranslate nohighlight">\(P(H_2) = \frac{2}{3}\)</span>, <span class="math notranslate nohighlight">\(P(S | H_1) = 1\)</span>, <span class="math notranslate nohighlight">\(P(S | H_2) = 0.49^2 + 0.51^2 = 0.5002\)</span>.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(S) = P(S | H_1)P(H_1) + P(S | H_2)P(H_2) = \frac{1}{3} + \frac{2}{3} \cdot 0.5002 = 0.6668
\]</div>
<div class="math notranslate nohighlight">
\[
P(H_2 | S) = \frac{\frac{2}{3} \cdot 0.5002}{0.6668} = 0.5001
\]</div>
<ol class="arabic simple" start="5">
<li><p><span class="math notranslate nohighlight">\(GG\)</span>- two girls, <span class="math notranslate nohighlight">\(P(GG | H_1) = 0.49\)</span>; <span class="math notranslate nohighlight">\(P(GG | H_2) = 0.49^2\)</span>;</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(GG) = 0.49 \cdot \frac{1}{3} + 0.49^2 \cdot \frac{2}{3} = 0.3234
\]</div>
<ol class="arabic simple" start="6">
<li><p>Done in part (d) as the denominator: <span class="math notranslate nohighlight">\(0.6668\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(P(H_2 | GG) = \frac{P(GG | H_2)P(H_2)}{P(GG)} = \frac{0.49^2 \cdot \frac{2}{3}}{0.3234} = 0.4949\)</span></p></li>
</ol>
</div>
</section>
<section id="hexi">
<h2>10. Hexi<a class="headerlink" href="#hexi" title="Permalink to this headline">#</a></h2>
<p>There is a 10% chance that pure breed German shepherd Hexi is a carrier of canine hemophilia A. If she is a carrier, there is a 50−50 chance that she will pass the hemophiliac gene to a puppy. Hexi has two male puppies and they are tested free of hemophilia. What is the probability that Hexi is a carrier, given this information about her puppies?</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p><strong>Problem setup and term definitions</strong></p>
<p><span class="math notranslate nohighlight">\(A\)</span>: The event that two male puppies are disease free.</p>
<p><span class="math notranslate nohighlight">\(H_1\)</span>: The event that Hexi is a carrier.</p>
<p><span class="math notranslate nohighlight">\(H_1^c\)</span>: The event that Hexi is not a carrier.</p>
<p><span class="math notranslate nohighlight">\(P(H_1) = .1\)</span>”There is a 10% chance … Hexi is a carrier.”</p>
<p><span class="math notranslate nohighlight">\(P(H_1^c) = .9\)</span></p>
<p>Independence comes into play with <span class="math notranslate nohighlight">\(P(A\mid H_1)\)</span>:</p>
<p><span class="math notranslate nohighlight">\(P(A\mid H_1) = .5 \times .5\)</span>”… if (Hexi) is a carrier, there is a 50–50 chance …”</p>
<p>Presumably, if she is not a carrier, there is a 100% chance her puppies will not have the disease:</p>
<p><span class="math notranslate nohighlight">\(P(A\mid H_1^c)=1\)</span></p>
<p><strong>Understanding the problem</strong></p>
<p>Bayes rule:</p>
<p><span class="math notranslate nohighlight">\(P(H_1\mid A)=\frac{P(A \mid H_1)P(H_1)}{P(A)}\)</span></p>
<p>The question asks for the probability that Hexi is a carrier “given this information about her puppies,” so know we immediately know this is a conditional probability. Based on how we’ve defined events above, we want <span class="math notranslate nohighlight">\(P(H_1\mid A)\)</span>.</p>
<p>We have an original, baseline value for <span class="math notranslate nohighlight">\(P(H_1)\)</span>, so we should see that we are updating that value given new evidence, that evidence being that two puppies are free of the disease. This points us to Bayes’ rule. We also already know <span class="math notranslate nohighlight">\(P(A|H_1)\)</span>. All we need is <span class="math notranslate nohighlight">\(P(A)\)</span>, which we can get using the law of total probability.</p>
<p><strong>Using the law of total probability to find P(A)</strong></p>
<p>Law of total probability:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(A) &amp;= \sum_{i=1}^n P(A\mid H_i)P(H_i) \\\
&amp;= P(A\mid H_1)P(H_1) + P(A\mid H_1^c)P(H_1^c) \\\
&amp;= (.5)(.5)(.1) + (1)(.9) = \textbf{.925}
\end{align*}\]</div>
<p><strong>Using Bayes’ rule</strong></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(H_1\mid A) &amp;=\frac{P(A \mid H_1)P(H_1)}{P(A)} \\
&amp;= \frac{(.5)(.5)(.1)}{.925} = \textbf{.}\overline{\textbf{027}}
\end{align*}\]</div>
<p>Does this answer make sense intuitively? Our evidence is against Hexi being a carrier, and <span class="math notranslate nohighlight">\(.\overline{027} \lt .1\)</span>, so yes.</p>
<p><strong>Considering each puppy separately</strong></p>
<p>Same setup as above, except we will define <span class="math notranslate nohighlight">\(B\)</span>as the event where one puppy does not have the disease (<span class="math notranslate nohighlight">\(P(B) = .5\)</span>).</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(B) &amp;= \sum_{i=1}^n P(B\mid H_i)P(H_i) \\\
&amp;= P(B\mid H_1)P(H_1) + P(B\mid H_1^c)P(H_1^c) \\\
&amp;= (.5)(.1) + (1)(.9) = \textbf{.95}
\end{align*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(H_1\mid B) &amp;=\frac{P(B \mid H_1)P(H_1)}{P(B)} \\
&amp;= \frac{(.5)(.1)}{.95} = \textbf{.05263}
\end{align*}\]</div>
<p>Now our new <span class="math notranslate nohighlight">\(H_1\)</span> is the above. We can update again, performing the exact same steps with a second event <span class="math notranslate nohighlight">\(B\)</span>, just replacing <span class="math notranslate nohighlight">\(H_1\)</span>with this new value. I’m using 5 decimal points while writing this out but actually using exact values for the calculations.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(B) &amp;= \sum_{i=1}^n P(B\mid H_i)P(H_i) \\\
&amp;= P(B\mid H_1)P(H_1) + P(B\mid H_1^c)P(H_1^c) \\\
&amp;= (.5)(P(H_1)) + (1)(1-P(H_1)) = \textbf{.97368}
\end{align*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}P(H_1\mid B) &amp;=\frac{P(B \mid H_1)P(H_1)}{P(B)} \\
&amp;= \frac{(.5)(.05263)}{.97368} = \textbf{.}\overline{\textbf{027}}
\end{align*}\]</div>
</div>
</section>
<section id="playing-dice-at-the-casino">
<h2>11. Playing Dice at the Casino<a class="headerlink" href="#playing-dice-at-the-casino" title="Permalink to this headline">#</a></h2>
<p>You play the following game in a casino. You roll a pair of fair dice and then the croupier rolls a pair of fair dice as well. If the sum on the croupier’s dice is larger or equal than on yours, the casino wins. If the sum on your dice is strictly larger than 3 on croupier’s, you win.</p>
<ol class="arabic simple">
<li><p>What is the probability that you win?</p></li>
<li><p>If it is known that you won, what is the probability that croupier obtained a sum of 9?</p></li>
<li><p>What is the expected croupier’s sum if you won? Note that without any information on winners, the expected sum for both you and the croupier is 7.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(P(\text{Sum} = i) = \begin{cases}
\frac{i-1}{36}, &amp; 2 \leq i \leq 7 \\
\frac{13-i}{36}, &amp; 7 \leq i \leq 12
\end{cases}\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(\text{You won}) = \frac{1}{36} \cdot 0 + \frac{2}{36} \cdot \frac{1}{36} + \frac{3}{36} \cdot \frac{1}{36} + \frac{4}{36} \cdot \frac{1}{36} + \frac{5}{36} \cdot \frac{1}{36} + \frac{6}{36} \cdot \frac{1}{36} + \frac{5}{36} \cdot \frac{1}{36} + \frac{4}{36} \cdot \frac{1}{36} + \frac{3}{36} \cdot \frac{1}{36} + \frac{2}{36} \cdot \frac{1}{36} + \frac{1}{36} \cdot \frac{1}{36} = \frac{575}{1296} = 0.44367
\]</div>
<ol class="arabic simple" start="2">
<li><p>By Bayes’ formula:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
P(\text{Croupier} = 9 | \text{You won}) = \frac{P(\text{You won} | \text{Croupier} = 9) \cdot P(\text{Croupier} = 9)}{P(\text{You won})} = \frac{6/36 \cdot 4/36}{575/1296} = \frac{24}{575} = 0.04174
\]</div>
<ol class="arabic simple" start="3">
<li><p>Expectation of croupier’s sum if you won is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
E = \sum_{i=2}^{12} i \cdot P(\text{Croupier} = i | \text{You won})
\]</div>
<p>We already found that for <span class="math notranslate nohighlight">\(i = 9\)</span>, the probability is <span class="math notranslate nohighlight">\(\frac{24}{575}\)</span>. It is straightforward to find probabilities for other values of <span class="math notranslate nohighlight">\(i\)</span> and calculate the expectation. We can do it with the following Python script:</p>
<p>See hidden code cell below.</p>
<p>If you won, we expect that the croupier got the sum of <span class="math notranslate nohighlight">\(\frac{3136}{575} \approx 5.454\)</span>. This is less than 7 – the expectation without any information.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">casino</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">))</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">575</span>
<span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">casino</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>  <span class="c1"># 5.454</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">won</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">you</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">casino</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">casino</span> <span class="o">&lt;</span> <span class="n">you</span><span class="p">:</span>
        <span class="n">won</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Approx Prob of Winning =&quot;</span><span class="p">,</span> <span class="n">won</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="redundant-wiring">
<h2>12. Redundant Wiring<a class="headerlink" href="#redundant-wiring" title="Permalink to this headline">#</a></h2>
<p>In the circuit shown in the figure below, the electricity is to move from point A to point B.</p>
<p><img alt="circuit diagram" src="../_images/35q12circuit.jpg" /></p>
<p>The four independently working elements in the circuit are operational (and the current goes through) with probabilities given in the table</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Element</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(e_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(e_2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(e_3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(e_4\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Operational with prob</p></td>
<td><p>0.5</p></td>
<td><p>0.2</p></td>
<td><p>0.3</p></td>
<td><p>0.8</p></td>
</tr>
</tbody>
</table>
<p>If an element fails, the current is not going through.</p>
<ol class="arabic simple">
<li><p>Is it possible to save on the wire that connects the elements without affecting the functionality of the network? Explain which part of wiring can be removed.</p></li>
<li><p>Find the probability that the electricity will flow from A to B.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Hint: Although this configuration can be analyzed directly, it is simpler to condition on the element <span class="math notranslate nohighlight">\(e_1\)</span>and apply the Formula of Total Probability.</p>
<p><span class="math notranslate nohighlight">\(e_1 = 0.5\)</span></p>
<p><span class="math notranslate nohighlight">\(e_2 = 0.2\)</span></p>
<p><span class="math notranslate nohighlight">\(e_3 = 0.3\)</span></p>
<p><span class="math notranslate nohighlight">\(e_4 = 0.8\)</span></p>
<p><span class="math notranslate nohighlight">\(H_1 = e_1 \text{ working}\)</span></p>
<p><span class="math notranslate nohighlight">\(H_2 = e_1 \text{ not working}\)</span></p>
<p><span class="math notranslate nohighlight">\(P(B) = P(B|H_1)P(H_1) + P(B|H_2)P(H_2)\)</span></p>
<p>If <span class="math notranslate nohighlight">\(e_1\)</span> is not working (<span class="math notranslate nohighlight">\(H_2\)</span>):</p>
<p>Call the parallel connection circuit <span class="math notranslate nohighlight">\(C\)</span>:</p>
<p><span class="math notranslate nohighlight">\(P(C) = 1 - q_{e_1}q_{e_2}q_{e_3}\)</span></p>
<p><span class="math notranslate nohighlight">\(P(C) = 1 - (1)(0.8)(0.7) = 1 -  .56 = .44\)</span></p>
<p>Then it’s a serial connection with <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(e_4\)</span>:</p>
<p><span class="math notranslate nohighlight">\(P(B|H_2) = P(C)P(e_4) = (0.44)(0.8) = 0.352\)</span></p>
<p>If <span class="math notranslate nohighlight">\(e_1\)</span> is working (<span class="math notranslate nohighlight">\(H_1\)</span>):</p>
<p>We have a direct connection: <span class="math notranslate nohighlight">\(P(B|H_1) = P(e_1) = 1\)</span></p>
<p>All together:</p>
<p><span class="math notranslate nohighlight">\(P(B) = P(B|H_1)P(H_1) + P(B|H_2)P(H_2)\)</span></p>
<p><span class="math notranslate nohighlight">\(P(B) = (1)(0.5) + (0.352)(0.5) = 0.676\)</span></p>
<p>Thinking about whether the redundancy is worth it. What would the circuit look like without it?</p>
<p>What is <span class="math notranslate nohighlight">\(P(B)\)</span> without it?</p>
<p>Same as the <span class="math notranslate nohighlight">\(H_2\)</span> calculation except <span class="math notranslate nohighlight">\(q_{e_1} = 0.5\)</span>:</p>
<p><span class="math notranslate nohighlight">\(P(C) = 1 - q_{e_1}q_{e_2}q_{e_3}\)</span></p>
<p><span class="math notranslate nohighlight">\(P(C) = 1 - (0.5)(0.8)(0.7) = 0.72\)</span></p>
<p><span class="math notranslate nohighlight">\(P(B_{\text{no redundancy}}) = P(C)P(e_4) = (0.72)(0.8) = 0.576\)</span></p>
<p>So, <span class="math notranslate nohighlight">\(P(B) &gt; P(B_{\text{no redundancy}})\)</span>.</p>
</div>
</section>
<section id="cross-linked-system">
<h2>13. Cross-linked System<a class="headerlink" href="#cross-linked-system" title="Permalink to this headline">#</a></h2>
<p>Each of the five components in a cross-linked system is operational in a time interval <span class="math notranslate nohighlight">\([0, T]\)</span> with the probability of 0.6. The components are independent. Let <span class="math notranslate nohighlight">\(E_i\)</span> denote the event that <span class="math notranslate nohighlight">\(i\)</span>-th component is operational at time <span class="math notranslate nohighlight">\(T\)</span>and <span class="math notranslate nohighlight">\(E_i^c\)</span> that it is not. Denote by <span class="math notranslate nohighlight">\(A\)</span> the event that the system is operational at time <span class="math notranslate nohighlight">\(T\)</span>.</p>
<p><img alt="circuit diagram" src="../_images/35q13circuit.jpg" /></p>
<ol class="arabic simple">
<li><p>Find the probabilities of events <span class="math notranslate nohighlight">\(H_1 = E_2^c E_3^c\)</span>, <span class="math notranslate nohighlight">\(H_2 = E_2^c E_3\)</span>, <span class="math notranslate nohighlight">\(H_3 = E_2 E_3^c\)</span>, and <span class="math notranslate nohighlight">\(H_4 = E_2 E_3\)</span>. Do these four probabilities sum up to 1?</p></li>
<li><p>What is the probability of the system being operational if <span class="math notranslate nohighlight">\(H_1\)</span>is true; that is, what is <span class="math notranslate nohighlight">\(P(A | H_1)\)</span>? Find also <span class="math notranslate nohighlight">\(P(A | H_2)\)</span>, <span class="math notranslate nohighlight">\(P(A | H_3)\)</span> and <span class="math notranslate nohighlight">\(P(A | H_4)\)</span>.</p></li>
<li><p>Using results in (a) and (b), find <span class="math notranslate nohighlight">\(P(A)\)</span>.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Hint: <span class="math notranslate nohighlight">\(P(A | H_1) = 0\)</span>, <span class="math notranslate nohighlight">\(P(A | H_2) = 1 - 0.4 \cdot 0.4\)</span>, <span class="math notranslate nohighlight">\(P(A | H_3) = 0.6\)</span>, <span class="math notranslate nohighlight">\(P(A | H_4) = 1\)</span></p>
<p>See hidden code cell below.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">p</span>

<span class="c1"># P(H_i)</span>
<span class="n">H_1</span> <span class="o">=</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span>
<span class="n">H_2</span> <span class="o">=</span> <span class="n">q</span> <span class="o">*</span> <span class="n">p</span>
<span class="n">H_3</span> <span class="o">=</span> <span class="n">H_2</span>
<span class="n">H_4</span> <span class="o">=</span> <span class="n">p</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># part a</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H_1</span><span class="p">,</span> <span class="n">H_2</span><span class="p">,</span> <span class="n">H_3</span><span class="p">,</span> <span class="n">H_4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">H_1</span><span class="p">,</span> <span class="n">H_2</span><span class="p">,</span> <span class="n">H_3</span><span class="p">,</span> <span class="n">H_4</span><span class="p">]))</span>

<span class="c1"># part b</span>
<span class="c1"># P(A|H_i)</span>
<span class="c1"># if neither E_2 or E_3 are working, there&#39;s no viable path</span>
<span class="n">p_ah1</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># if E_2 isn&#39;t working, then only the E_3 -&gt; E_4/E_5 path is possible</span>
<span class="n">p_ah2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># if E_3 isn&#39;t working, only the top path will work</span>
<span class="n">p_ah3</span> <span class="o">=</span> <span class="n">p</span>

<span class="c1"># If E_3 and E_2 are assumed working, there is one guaranteed path for P(A) on the crosslink</span>
<span class="n">p_ah4</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># part c</span>
<span class="n">p_A</span> <span class="o">=</span> <span class="n">p_ah1</span> <span class="o">*</span> <span class="n">H_1</span> <span class="o">+</span> <span class="n">p_ah2</span> <span class="o">*</span> <span class="n">H_2</span> <span class="o">+</span> <span class="n">p_ah3</span> <span class="o">*</span> <span class="n">H_3</span> <span class="o">+</span> <span class="n">p_ah4</span> <span class="o">*</span> <span class="n">H_4</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_A</span><span class="p">)</span>  <span class="c1"># .7056</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following Bayes Network problems may be solved in many ways, including PyMC or other PPLs. OpenBUGS solutions are available at the <a class="reference external" href="https://www2.isye.gatech.edu/isye6420/supporting.html">old class website</a>. PPLs will not be required or allowed on the midterm, nor do we emphasize these types of problems because they can be so time-consuming.</p>
</div>
</section>
<section id="sprinkler-bayes-net">
<h2>14. Sprinkler Bayes Net<a class="headerlink" href="#sprinkler-bayes-net" title="Permalink to this headline">#</a></h2>
<p>Suppose that a sprinkler (S) or rain ® can make the grass in your yard wet (W). The probability that the sprinkler was on depends on whether the day was cloudy ©. The probability of rain also depends on whether the day was cloudy. The DAG for events <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(S\)</span>, <span class="math notranslate nohighlight">\(R\)</span>, and <span class="math notranslate nohighlight">\(W\)</span>is shown below:</p>
<p>The conditional probabilities of the nodes are given in the following tables:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
C^c &amp; C \\
0.5 &amp; 0.5 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
S^c &amp; S &amp; \text{Condition} \\
0.50 &amp; 0.50 &amp; C^c \\
0.90 &amp; 0.10 &amp; C \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
R^c &amp; R &amp; \text{Condition} \\
0.80 &amp; 0.20 &amp; C^c \\
0.20 &amp; 0.80 &amp; C \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
W^c &amp; W &amp; \text{Condition} \\
1 &amp; 0 &amp; S^c R^c \\
0.10 &amp; 0.90 &amp; S^c R \\
0.10 &amp; 0.90 &amp; S R^c \\
0.01 &amp; 0.99 &amp; S R \\
\end{array}
\end{split}\]</div>
<p>Approximate the probabilities:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(P(C | W)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(S | W^c)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P(C | R, W^c)\)</span></p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>See the hidden code cell below for an exact calculation in Python, contributed by Jason Naramore.</p>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># W = Wet, C = Cloudy, S = Sprinkler, R = Rain</span>
<span class="c1">#&#39;n&#39; represents &#39;not&#39;</span>
<span class="n">p_W_C_S_R</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.99</span>
<span class="n">p_W_C_S_Rn</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="mf">0.9</span>
<span class="n">p_W_C_Sn_R</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.9</span>
<span class="n">p_W_C_Sn_Rn</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="mi">0</span>

<span class="n">p_W_Cn_S_R</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="mf">0.99</span>
<span class="n">p_W_Cn_S_Rn</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mf">0.9</span>
<span class="n">p_W_Cn_Sn_R</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="mf">0.9</span>
<span class="n">p_W_Cn_Sn_Rn</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="mi">0</span>

<span class="c1"># combine cloudy and not cloudy terms</span>
<span class="n">p_C</span> <span class="o">=</span> <span class="n">p_W_C_S_R</span> <span class="o">+</span> <span class="n">p_W_C_S_Rn</span> <span class="o">+</span> <span class="n">p_W_C_Sn_R</span> <span class="o">+</span> <span class="n">p_W_C_Sn_Rn</span>
<span class="n">p_Cn</span> <span class="o">=</span> <span class="n">p_W_Cn_S_R</span> <span class="o">+</span> <span class="n">p_W_Cn_S_Rn</span> <span class="o">+</span> <span class="n">p_W_Cn_Sn_R</span> <span class="o">+</span> <span class="n">p_W_Cn_Sn_Rn</span>

<span class="c1"># P(C|W)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_C</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_C</span> <span class="o">+</span> <span class="n">p_Cn</span><span class="p">))</span>
<span class="c1"># output = 0.5757997218358832</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="simple-diagnostic-bayes-network">
<h2>15. Simple Diagnostic Bayes Network<a class="headerlink" href="#simple-diagnostic-bayes-network" title="Permalink to this headline">#</a></h2>
<p>Incidences of diseases <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> depend on the exposure (E). Disease <span class="math notranslate nohighlight">\(A\)</span> is additionally influenced by risk factors ®. Both diseases lead to symptoms (S). Results of the test for disease <span class="math notranslate nohighlight">\(B\)</span>(<span class="math notranslate nohighlight">\(T_B\)</span>) are affected also by disease <span class="math notranslate nohighlight">\(A\)</span>. Positive test will be denoted as <span class="math notranslate nohighlight">\(T_B = 1\)</span>, negative as <span class="math notranslate nohighlight">\(T_B = 0\)</span>. The Bayes Network and needed conditional probabilities are shown in Figure.</p>
<p>The probabilities of nodes are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
E &amp; 0 &amp; 1 \\
&amp; 0.8 &amp; 0.2 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
R &amp; 0 &amp; 1 \\
&amp; 0.7 &amp; 0.3 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
A &amp; 0 &amp; 1 \\
E^c &amp; 0.9 &amp; 0.1 \\
E &amp; 0.5 &amp; 0.5 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
B &amp; 0 &amp; 1 \\
E^c R^c &amp; 0.95 &amp; 0.05 \\
E^c R &amp; 0.8 &amp; 0.2 \\
E R^c &amp; 0.7 &amp; 0.3 \\
E R &amp; 0.25 &amp; 0.75 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
S &amp; 0 &amp; 1 \\
A^c B^c &amp; 0.99 &amp; 0.01 \\
A^c B &amp; 0.5 &amp; 0.5 \\
A B^c &amp; 0.8 &amp; 0.2 \\
A B &amp; 0.4 &amp; 0.6 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c}
T_B &amp; 0 &amp; 1 \\
A^c B^c &amp; 0.99 &amp; 0.01 \\
A^c B &amp; 0.2 &amp; 0.8 \\
A B^c &amp; 0.95 &amp; 0.05 \\
A B &amp; 0.15 &amp; 0.85 \\
\end{array}
\end{split}\]</div>
<ol class="arabic simple">
<li><p>What is the probability of disease <span class="math notranslate nohighlight">\(B\)</span>, if disease <span class="math notranslate nohighlight">\(A\)</span> is not present, but symptoms <span class="math notranslate nohighlight">\(S\)</span> are present?</p></li>
<li><p>What is the probability of exposure <span class="math notranslate nohighlight">\(E\)</span>, if symptoms are present <span class="math notranslate nohighlight">\(S\)</span> and test for <span class="math notranslate nohighlight">\(B\)</span> is positive?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>See hidden code cell below.</p>
<p><span class="output text_plain">‘P(B|A=0, S=1) = 0.8841’</span></p>
<p><span class="output text_plain">‘P(E|S=1, T_B=1) = 0.5635’</span></p>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pytensor</span>
<span class="kn">import</span> <span class="nn">pytensor.tensor</span> <span class="k">as</span> <span class="nn">pt</span>


<span class="c1"># PyMC solution based on this notebook:</span>
<span class="c1"># https://gist.github.com/Dekermanjian/35aa0340c673cb6cc7f9fbd95e8e764d</span>

<span class="n">table_A</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]]))</span>
<span class="n">table_B</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]]])</span>
<span class="p">)</span>
<span class="n">table_S</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]]])</span>
<span class="p">)</span>
<span class="n">table_T_B</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">shared</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">]]])</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">lookup_A</span><span class="p">(</span><span class="n">E</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">table_A</span><span class="p">[</span><span class="n">E</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">lookup_B</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">table_B</span><span class="p">[</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">lookup_S</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">table_S</span><span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">lookup_T_B</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">table_T_B</span><span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span>


<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]))</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]))</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">lookup_A</span><span class="p">(</span><span class="n">E</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">lookup_B</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">))</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">lookup_S</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>
    <span class="n">T_B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;T_B&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">lookup_T_B</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span>

    <span class="n">prior_trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample_prior_predictive</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>

<span class="n">prior_trace_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;E&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">],</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">],</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">],</span>
    <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">],</span>
    <span class="s2">&quot;T_B&quot;</span><span class="p">:</span> <span class="n">prior_trace</span><span class="o">.</span><span class="n">prior</span><span class="p">[</span><span class="s2">&quot;T_B&quot;</span><span class="p">],</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">conditional_probabilities</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">conditions</span><span class="p">):</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
        <span class="p">[</span><span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">conditions</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">subset</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">prob</span>


<span class="n">P_B_given_A0_S1</span> <span class="o">=</span> <span class="n">conditional_probabilities</span><span class="p">(</span>
    <span class="n">prior_trace_dict</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">P_E_given_S1_T_B1</span> <span class="o">=</span> <span class="n">conditional_probabilities</span><span class="p">(</span>
    <span class="n">prior_trace_dict</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;T_B&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># print(f&quot;P(B|A=0, S=1) = {P_B_given_A0_S1}&quot;)  # ~ 0.8899</span>
<span class="c1"># print(f&quot;P(E|S=1, T_B=1) = {P_E_given_S1_T_B1}&quot;)  # ~ 0.5571</span>

<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;glued_txt_15_1&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;P(B|A=0, S=1) = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">P_B_given_A0_S1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;glued_txt_15_2&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;P(E|S=1, T_B=1) = </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">P_E_given_S1_T_B1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling: [A, B, E, R, S, T_B]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;P(B|A=0, S=1) = 0.8841&#39;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;P(E|S=1, T_B=1) = 0.5635&#39;
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="smart-alarm">
<h2>16. Smart Alarm<a class="headerlink" href="#smart-alarm" title="Permalink to this headline">#</a></h2>
<p>Your house has a “smart” alarm system that warns you against burglary with a long sound. The house is located in a seismically active area and the alarm system will emit a short sound if set off by an earthquake. The alarm can sound either way by error, or nor sound even in the case of earthquake or burglary. You have two neighbors, Mary and John, who do not know each other. If they hear the alarm they call you, but this is not guaranteed. The likelihood of their call depends on type of sound if any. They also call you from time to time just to chat. The probabilities are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
E &amp; 0 &amp; 1 \\
&amp; 0.998 &amp; 0.002 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
B &amp; 0 &amp; 1 \\
&amp; 0.999 &amp; 0.001 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c|c|c}
A &amp; 0 &amp; 1 &amp; 2 \\
E^c B^c &amp; 0.998 &amp; 0.001 &amp; 0.001 \\
E^c B &amp; 0.01 &amp; 0.12 &amp; 0.87 \\
E B^c &amp; 0.01 &amp; 0.75 &amp; 0.24 \\
E B &amp; 0.008 &amp; 0.092 &amp; 0.9 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
M &amp; 0 &amp; 1 \\
A = 0 &amp; 0.99 &amp; 0.01 \\
A = 1 &amp; 0.4 &amp; 0.6 \\
A = 2 &amp; 0.3 &amp; 0.7 \\
\end{array}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
J &amp; 0 &amp; 1 \\
A = 0 &amp; 0.95 &amp; 0.05 \\
A = 1 &amp; 0.1 &amp; 0.9 \\
A = 2 &amp; 0.05 &amp; 0.95 \\
\end{array}
\end{split}\]</div>
<p>Write BUGS code to approximate conditional probabilities of nodes given the evidence.</p>
<ol class="arabic simple">
<li><p>Find the probability of a burglary if a short sound was emitted by the alarm;</p></li>
<li><p>Find the probability of Mary calling you if John called you;</p></li>
<li><p>Find the probability of a short sound if John called you and there was no earthquake;</p></li>
<li><p>Find the probability of any sound if there was no burglary and Mary did not call you;</p></li>
<li><p>Find the probability of an earthquake if a long sound was emitted by the alarm.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>See <a class="reference external" href="https://areding.github.io/6420-pymc/unit3/Unit3-Alarm.html">Unit 3 Lesson 8</a>.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./unit3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Unit3-Emily.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Supplementary Problem: Emily’s Vacation*</p>
      </div>
    </a>
    <a class="right-next"
       href="../unit4/distributions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Probability Distributions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-neighbors">1. New neighbors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#new-neighbors-with-three-children">2. New neighbors with three children</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#queen-of-spades-revisited">3. Queen of spades revisited</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-choice">4. Multiple Choice</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classifier">5. Classifier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alzheimers">6. Alzheimer’s</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mysterious-transfer">7. Mysterious Transfer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nir-and-raman-in-parkinsons">8. NIR and Raman in Parkinson’s</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#twins">9. Twins</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hexi">10. Hexi</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-dice-at-the-casino">11. Playing Dice at the Casino</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#redundant-wiring">12. Redundant Wiring</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-linked-system">13. Cross-linked System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sprinkler-bayes-net">14. Sprinkler Bayes Net</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-diagnostic-bayes-network">15. Simple Diagnostic Bayes Network</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-alarm">16. Smart Alarm</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aaron Reding
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>