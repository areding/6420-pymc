

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Supplementary Exercises &#8212; ISYE 6420 - BUGS to PyMC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'unit7/SupplementaryExercises74';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. Missing Data" href="../unit8/Unit8-missing.html" />
    <link rel="prev" title="19. Paraguay Vaccination Status*" href="Unit7-demo-multilevel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo2.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo2.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-about-this-course.html">1. About This Course</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-topics.html">2. Topics Covered</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-software.html">3. Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit1/Unit1-simple-regression.html">4. A Simple Regression*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-history.html">1. History of Bayesian Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-history2.html">2. Historic Overview Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-bayesianvsclassical.html">3. Bayesian vs. Frequentist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-10flips.html">4. Ten Coin Flips*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit2/Unit2-fda.html">5. FDA Recommendations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-NecessaryProbability.html">1. A Review of Necessary Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-conditioning1.html">2. Conditioning, Part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-conditioning2.html">3. Conditioning, Part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-Bayes-theorem.html">4. Bayes’ Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-ManufacturingBayes.html">5. Manufacturing Bayes*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-TwoHeadedCoin.html">6. Two-headed Coin*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-bayesnetworks.html">7. Bayes Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-Alarm.html">8. Alarm*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/Unit3-Emily.html">9. Supplementary Problem: Emily’s Vacation*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit3/SupplementaryExercises35.html">10. Supplementary Exercises*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/distributions.html">Probability Distributions</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-basicdist.html">1. Basic Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-numericalchar.html">2. Numerical Characteristics of Random Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-jointconditionals.html">3. Joint and Conditional Distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/bayestheorem.html">Bayes’ Theorem</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-ingredients.html">4. Ingredients for Bayesian Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-conjugatefamilies.html">5. Conjugate Families</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-IQexample.html">6. Example: Jeremy’s IQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-BetaPriors.html">7. Ten Coin Flips Revisited: Beta Plots*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-poissongamma.html">8. Poisson–Gamma Model</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/conjugatecases.html">Bayesian Inference in Conjugate Cases</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-estimation.html">9. Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-crediblesets.html">10. Credible Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-GammaGamma.html">11. Gamma Gamma*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-testing.html">12. Bayesian Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-prediction.html">13. Prediction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/priors.html">Priors</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-elicitation.html">14. Prior Elicitation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-noninform.html">15. Non-informative Priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-samplesize.html">16. Prior Sample Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-eBay.html">17. eBay Purchase Example*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/empiricalbayes.html">Empirical Bayes</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-parametric.html">18. Parametric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-nonpara.html">19. Non-parametric</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit4/moreexamples.html">More Examples</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit4/Unit4-AlphaParticles.html">20. Counts of Alpha Particles*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/SupplementaryExercises43.html">Supplementary Exercises 4.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit4/SupplementaryExercises48.html">Supplementary Exercises 4.8</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/bayesian-computation.html">Bayesian Computation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-numericalapproaches.html">1. Numerical Approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-norcau1.html">2. Normal–Cauchy Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Laplace.html">3. Laplace’s Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-demo-Laplaces-method.html">4. Laplace’s Method Demo*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-mcmc.html">5. Markov Chain Monte Carlo</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/metropolis-hastings.html">The Metropolis Algorithm</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Metropolis.html">6. Metropolis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Metropolis1.html">7. Metropolis: Normal-Cauchy*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-MetropolisHastings.html">8. Metropolis–Hastings: Weibull-Exponential Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-MetropolisHastings2.html">9. Weibull Lifetimes*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/gibbs-sampling.html">Gibbs Sampling</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbsintro.html">10. Introduction to Gibbs Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-GibbsSampler.html">11. Normal-Cauchy Gibbs Sampler*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbs2.html">12. Conjugate Gamma-Poisson Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-PumpsMCMC.html">13. Pumps*</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-gibbsex3math.html">14. Change Point Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-Gibbs3.html">15. Coal Mining Disasters in the UK*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../unit5/other.html">Other Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-hamiltonian.html">16. Hamiltonian Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/Unit5-other-methods.html">17. Going Further</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit5/SupplementaryExercises54.html">Supplementary Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-probabilisticprogramming.html">1. Probabilistic Programming Languages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-doodlebug.html">2. Creating a Graphical Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-demo-doodle.html">3. Joint Probability Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-moreaboutpymc.html">4. More About PyMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-loadingdata.html">5. Loading Data, Step Function, and Deterministic Variables*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-missingdata.html">6. Missing Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-htesting.html">7. Hypothesis Testing*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-prediction.html">8. Prediction*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-censoring.html">9. Type-1 Censoring*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit6/Unit6-customlikelihood.html">10. The Zero Trick and Custom Likelihoods*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 7</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="hierarchical.html">Hierarchical Models</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="Unit7-introduction.html">1. Introduction to Hierarchical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-why.html">2. Reasons to Use Hierarchical Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-priors.html">3. Priors with Structural Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-hiddenmixtures.html">4. Priors as Hidden Mixtures*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-metaanalysis.html">5. Meta-analysis via Hierarchical Models*</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="linearmodels.html">Linear Models</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="Unit7-anova.html">6. Analysis of Variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-coagulation.html">7. Coagulation*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-factorial.html">8. Factorial Designs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-demo-factorial.html">9. Simvastatin*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-regression.html">10. Linear Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-demo-regression.html">11. Brozek index prediction*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-multipleregression.html">12. Multiple Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-demo-multiple.html">13. Multiple Regression: Brozek Index Prediction*</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="othermodels.html">Other Models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Unit7-other.html">14. Generalized Linear Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-arrhythmia.html">15. GLM Examples*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-multinomial.html">16. Multinomial Logit</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-demo-multinomial.html">17. Multinomial regression*</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-multilevel.html">18. Multilevel Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="Unit7-demo-multilevel.html">19. Paraguay Vaccination Status*</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Supplementary Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 8</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-missing.html">1. Missing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-missrats.html">2. Rats Example with Missing Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-timetoevent.html">3. Time-to-event Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tteex1.html">4. Time-to-event Models: Example 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tteex2.html">5. Time-to-event Models: Example 2*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit8/Unit8-tte-gastric.html">6. Time-to-event Models: Gastric Cancer*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-fit-selection-diagnostics.html">1. Model Fit, Selection, and Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-dic.html">2. Deviance Information Criterion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-fitsel.html">3. Model Fit and Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-hald.html">4. Hald*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cpo.html">5. Conditional Predictive Ordinate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-gessell.html">6. Gesell*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cumulative.html">7. Using the Empirical CDF and the Probability Integral Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-cumulative2.html">8. Cumulative Example*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-ssvs.html">9. Stochastic Search Variable Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit9/Unit9-hald2.html">10. SSVS: Hald*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Unit 10</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-lister.html">1. Lister*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-growth.html">2. Dental Development*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-disasters.html">3. Revisiting UK Coal Mining Disasters*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-rasch.html">4. Rasch*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-italywines123.html">5. Wine Classification*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-katla.html">6. Predicting Using Censored Data*</a></li>
<li class="toctree-l1"><a class="reference internal" href="../unit10/Unit10-sunspots.html">7. Prediction of Time Series*</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../backmatter/bibliography.html">1. Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backmatter/latex_reference.html">2. Latex Reference</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/areding/6420-pymc/blob/main/unit7/SupplementaryExercises74.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/areding/6420-pymc" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/areding/6420-pymc/issues/new?title=Issue%20on%20page%20%2Funit7/SupplementaryExercises74.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/unit7/SupplementaryExercises74.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Supplementary Exercises</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beetles-bliss-data">1. Beetles (Bliss Data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vasoconstriction">2. Vasoconstriction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caesarean-delivery-categorical-response">3. Caesarean Delivery: Categorical Response</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#magnesium-ammonium-phosphate-and-chrysanthemums">4. Magnesium Ammonium Phosphate and Chrysanthemums</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#third-degree-burns">5. Third-degree Burns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shocks">6. Shocks!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-regression-and-iop">7. Binary Regression and IOP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#negative-binomial-as-a-gamma-mixture-of-poissons">8. Negative Binomial as a Gamma Mixture of Poissons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sex-of-diamond-backed-terrapins-and-incubation-temperature">9. Sex of Diamond-backed Terrapins and Incubation Temperature</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="supplementary-exercises">
<h1>Supplementary Exercises<a class="headerlink" href="#supplementary-exercises" title="Permalink to this headline">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This page contains solutions! We recommend attempting each problem before peeking.</p>
</div>
<section id="beetles-bliss-data">
<h2>1. Beetles (Bliss Data)<a class="headerlink" href="#beetles-bliss-data" title="Permalink to this headline">#</a></h2>
<p>In his 1935 paper, Bliss provides a table showing a number of flour beetles killed after 5 hours of exposure to gaseous carbon disulfide at various concentrations. This data set has since been used extensively by statisticians to illustrate and compare models for binary and binomial data.</p>
<p>Use logistic regression on the following data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.6907</span><span class="p">,</span> <span class="mf">1.7242</span><span class="p">,</span> <span class="mf">1.7552</span><span class="p">,</span> <span class="mf">1.7842</span><span class="p">,</span> <span class="mf">1.8113</span><span class="p">,</span> <span class="mf">1.8369</span><span class="p">,</span> <span class="mf">1.8610</span><span class="p">,</span> <span class="mf">1.8839</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
<p>Use one of the logit, probit, cloglog, loglog, or cauchyit link functions.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The logistic regression model will look like this:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_i | \boldsymbol{\beta}, \mathbf{x}_i &amp;\sim \text{Binomial}(n_i, p_i) \\
g(p_i) &amp;= \beta_0 + \sum_{j=1}^p \beta_j x_{ij} \\
\beta_0 &amp;\sim \mathcal{N}(0, \sigma_0^2) \\
\beta_j &amp;\sim \mathcal{N}(0, \sigma^2), \quad j = 0, 1, \ldots, p
\end{align*}\]</div>
<p>where <span class="math notranslate nohighlight">\(g(\cdot)\)</span> is the link function.</p>
<p><strong>For logit:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{logit}(p) = \ln\left(\frac{p}{1-p}\right)
\]</div>
<p>and its inverse <span class="math notranslate nohighlight">\(g^{-1}(\cdot)\)</span> is the logistic function:</p>
<div class="math notranslate nohighlight">
\[
\text{logistic}(x) = \frac{1}{1 + e^{-x}}
\]</div>
<p><strong>For probit:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{probit}(p) = \Phi^{-1}(p)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi\)</span> is the cumulative distribution function of the standard normal distribution:</p>
<div class="math notranslate nohighlight">
\[
\Phi(x) = \frac{1}{2}\left[1 + \text{erf}\left(\frac{x}{\sqrt{2}}\right)\right]
\]</div>
<p><span class="math notranslate nohighlight">\(\text{erf}\)</span> is the error function:</p>
<div class="math notranslate nohighlight">
\[
\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_0^x e^{-t^2} \, dt
\]</div>
<p><strong>For cloglog (complementary log-log):</strong></p>
<div class="math notranslate nohighlight">
\[
\text{cloglog}(p) = \log(-\log(1 - p))
\]</div>
<p>and its inverse <span class="math notranslate nohighlight">\(g^{-1}(\cdot)\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
g^{-1}(x) = 1 - e^{-e^x}
\]</div>
<p><strong>For loglog:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{loglog}(p) = -\log(-\log(p))
\]</div>
<p>and its inverse <span class="math notranslate nohighlight">\(g^{-1}(\cdot)\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
g^{-1}(x) = e^{-e^{-x}}
\]</div>
<p><strong>For cauchyit:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{cauchyit}(p) = \tan\left(\pi \left(p - \frac{1}{2}\right)\right)
\]</div>
<p>and its inverse <span class="math notranslate nohighlight">\(g^{-1}(\cdot)\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
g^{-1}(x) = \frac{1}{2} + \frac{1}{\pi} \arctan(x)
\]</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymc.math</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">invlogit</span><span class="p">,</span> <span class="n">invprobit</span><span class="p">,</span> <span class="n">arctan</span>


<span class="c1"># Complementary log-log transformation</span>
<span class="k">def</span> <span class="nf">invcloglog</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>


<span class="c1"># Log-log transformation</span>
<span class="k">def</span> <span class="nf">invloglog</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>


<span class="c1"># Cauchit transformation</span>
<span class="k">def</span> <span class="nf">invcauchit</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.6907</span><span class="p">,</span> <span class="mf">1.7242</span><span class="p">,</span> <span class="mf">1.7552</span><span class="p">,</span> <span class="mf">1.7842</span><span class="p">,</span> <span class="mf">1.8113</span><span class="p">,</span> <span class="mf">1.8369</span><span class="p">,</span> <span class="mf">1.8610</span><span class="p">,</span> <span class="mf">1.8839</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">m</span><span class="p">:</span>
    <span class="n">x_data</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">MutableData</span><span class="p">(</span><span class="s2">&quot;concentration&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">beta0</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;beta0&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">beta1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;beta1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="c1"># Uncomment desired link function</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">invlogit</span><span class="p">(</span><span class="n">beta0</span> <span class="o">+</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">)</span>  <span class="c1"># logit</span>
    <span class="c1"># p = invprobit(beta0 + beta1 * x_data)  # probit</span>
    <span class="c1"># p = invcloglog(beta0 + beta1 * x_data)  # cloglog</span>
    <span class="c1"># p = invloglog(beta0 + beta1 * x_data)  # loglog</span>
    <span class="c1"># p = invcauchit(beta0 + beta1 * x_data)  # cauchyit</span>

    <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="s2">&quot;likelihood&quot;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;stats&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [beta0, beta1]
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='24000' class='' max='24000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [24000/24000 00:10&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 5_000 draw iterations (4_000 + 20_000 draws total) took 11 seconds.
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>beta0</th>
      <td>-60.962</td>
      <td>5.224</td>
      <td>-70.699</td>
      <td>-51.333</td>
    </tr>
    <tr>
      <th>beta1</th>
      <td>34.408</td>
      <td>2.937</td>
      <td>29.094</td>
      <td>39.977</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
</section>
<section id="vasoconstriction">
<h2>2. Vasoconstriction<a class="headerlink" href="#vasoconstriction" title="Permalink to this headline">#</a></h2>
<p>The data give the presence or absence (<span class="math notranslate nohighlight">\(y_i = 1\)</span> or <span class="math notranslate nohighlight">\(0\)</span>) of vasoconstriction in the skin of the fingers following inhalation of a certain volume of air (<span class="math notranslate nohighlight">\(v_i\)</span>) at a certain average rate (<span class="math notranslate nohighlight">\(r_i\)</span>). Total number of records is 39. The candidate models for analyzing the relationship are the usual logit, probit, cloglog, loglog, and cauchyit models.</p>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/vasoconstriction.csv">here</a>.</p>
<ol class="arabic simple">
<li><p>Transform covariates <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(r\)</span> as:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
x_1 = \log(10 \times v), \quad x_2 = \log(10 \times r)
\]</div>
<ol class="arabic simple" start="2">
<li><p>Using a PPL, estimate posterior means for coefficients in the logit model. Use noninformative priors on all coefficients.</p></li>
<li><p>For a subject with <span class="math notranslate nohighlight">\(v = r = 1.5\)</span>, find the probability of vasoconstriction.</p></li>
<li><p>Which of the five links: logit, probit, cloglog, loglog, and cauchyit, has the smallest deviance? An example for use of the five links is in Question 1, above. Uncomment and run one link at a time.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="caesarean-delivery-categorical-response">
<h2>3. Caesarean Delivery: Categorical Response<a class="headerlink" href="#caesarean-delivery-categorical-response" title="Permalink to this headline">#</a></h2>
<p>Table 1 contains grouped data on infection of mothers after a C-section, collected at the Clinical Center of the University of Munich. The response variable has three categories: Infection of type I, Infection of type II, and No infection. For each mother three covariates are collected:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\text{NOPLAN} &amp;= 
\begin{cases} 
1 &amp; \text{C-section was not planned} \\
0 &amp; \text{Planned} 
\end{cases} \\
\text{RISK} &amp;= 
\begin{cases} 
1 &amp; \text{Risk factors present} \\
0 &amp; \text{No risk factors} 
\end{cases} \\
\text{ANTIB} &amp;= 
\begin{cases} 
1 &amp; \text{Antibiotics given as prophylaxis} \\
0 &amp; \text{No antibiotics given} 
\end{cases}
\end{align*}\]</div>
<ol class="arabic simple">
<li><p>Given the covariates, establish a multinomial model, where the outcome “No infection” serves as a baseline.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\text{Table 1: Data on infections for 251 C-sections.}
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|l|lll|lll|}
\hline
&amp; \rlap{\text{Planned}} &amp; &amp; &amp; \rlap{\text{Unplanned}} &amp; &amp; \\
\text{Infection} &amp; \text{I} &amp; \text{II} &amp; \text{No} &amp; \text{I} &amp; \text{II} &amp; \text{No} \\
\hline
\textbf{Antibiotics} &amp; &amp; &amp; &amp; &amp; &amp; \\
\hspace{1em}\text{Risk factor} &amp; 0 &amp; 1 &amp; 17 &amp; 4 &amp; 7 &amp; 87 \\
\hspace{1em}\text{No risk factor} &amp; 0 &amp; 0 &amp; 2 &amp; 0 &amp; 0 &amp; 0 \\
\hline
\textbf{No Antibiotics} &amp; &amp; &amp; &amp; &amp; &amp; \\
\hspace{1em}\text{Risk factor} &amp; 11 &amp; 17 &amp; 30 &amp; 10 &amp; 13 &amp; 3 \\
\hspace{1em}\text{No risk factor} &amp; 4 &amp; 4 &amp; 32 &amp; 0 &amp; 0 &amp; 9 \\
\hline
\end{array}
\end{split}\]</div>
<ol class="arabic simple">
<li><p>A new C-section delivery for a mother with covariates <span class="math notranslate nohighlight">\((\text{NOPLAN}, \text{RISK}, \text{ANTIBIO}) = (1, 0, 0)\)</span> is to be evaluated for risks of infection. What are the estimated probabilities of no infection, and type I and II infections?</p></li>
</ol>
<p>Hint: Consult <a class="reference internal" href="Unit7-demo-multinomial.html"><span class="doc std std-doc">17. Multinomial regression*</span></a>.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="magnesium-ammonium-phosphate-and-chrysanthemums">
<h2>4. Magnesium Ammonium Phosphate and Chrysanthemums<a class="headerlink" href="#magnesium-ammonium-phosphate-and-chrysanthemums" title="Permalink to this headline">#</a></h2>
<p>Walpole et al. (2007) provide data from a study on the effect of magnesium ammonium phosphate on the height of chrysanthemums, which was conducted at George Mason University in order to determine a possible optimum level of fertilization, based on the enhanced vertical growth response of the chrysanthemums. Forty chrysanthemum seedlings were assigned to 4 groups, each containing 10 plants. Each was planted in a similar pot containing a uniform growth medium. An increasing concentration of <span class="math notranslate nohighlight">\(\text{MgNH}_4\text{PO}_4\)</span>, measured in grams per bushel, was added to each plant. The 4 groups of plants were grown under uniform conditions in a greenhouse for a period of 4 weeks. The treatments and the respective changes in heights, measured in centimeters, are given in the following table:</p>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/chrysanthemums.csv">here</a>.</p>
<p>Solve the problem as a Bayesian one-way ANOVA. Use STZ constraints on treatment effects.</p>
<ol class="arabic simple">
<li><p>Do different concentrations of <span class="math notranslate nohighlight">\(\text{MgNH}_4\text{PO}_4\)</span> affect the average attained height of chrysanthemums? Look at the 95% credible sets for the differences between treatment effects.</p></li>
<li><p>Find the 95% credible set for the contrast <span class="math notranslate nohighlight">\(\mu_1 - \mu_2 - \mu_3 + \mu_4\)</span>.</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="third-degree-burns">
<h2>5. Third-degree Burns<a class="headerlink" href="#third-degree-burns" title="Permalink to this headline">#</a></h2>
<p>The data for this exercise, discussed in Fan et al. (1995), refer to <span class="math notranslate nohighlight">\(n = 435\)</span> adults who were treated for third-degree burns by the University of Southern California General Hospital Burn Center. The patients were grouped according to the area of third-degree burns on the body. For each midpoint of the groupings “log(area +1),” the number of patients in the corresponding group who survived and the number who died from the burns was recorded:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|c|c|c|}
\hline
\text{Log(area+1)} &amp; \text{Survived} &amp; \text{Died} \\
\hline
1.35 &amp; 13 &amp; 0 \\
1.60 &amp; 19 &amp; 0 \\
1.75 &amp; 67 &amp; 2 \\
1.85 &amp; 45 &amp; 5 \\
1.95 &amp; 71 &amp; 8 \\
2.05 &amp; 50 &amp; 20 \\
2.15 &amp; 35 &amp; 31 \\
2.25 &amp; 7 &amp; 49 \\
2.35 &amp; 1 &amp; 12 \\
\hline
\end{array}
\end{split}\]</div>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/thirddegreeburns.csv">here</a>.</p>
<ol class="arabic simple">
<li><p>Fit the logistic regression on the probability of death due to third-degree burns with the covariate <span class="math notranslate nohighlight">\(x = \log(\text{area} + 1)\)</span>. What is the deviance?</p></li>
<li><p>Using your model, estimate the posterior probability of survival for a person for whom <span class="math notranslate nohighlight">\(\log(\text{area} + 1)\)</span> equals 2.</p></li>
<li><p>Repeat (a) with probit and complementary log-log links. In terms of deviance, which model provides the best fit?</p></li>
</ol>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="shocks">
<h2>6. Shocks!<a class="headerlink" href="#shocks" title="Permalink to this headline">#</a></h2>
<p>An experiment was conducted to assess the effect of small electrical currents on farm animals, with the eventual goal of understanding the effects of high-voltage powerlines on livestock. The experiment was carried out with seven cows, and six shock intensities, 0, 1, 2, 3, 4, and 5 milliamps (shocks on the order of 15 milliamps are painful for many humans). Each cow was given 30 shocks, five at each intensity, in random order. The entire experiment was then repeated, so each cow received a total of 60 shocks. For each shock the response, mouth movement, was either present or absent. The data as quoted give the total number of responses, out of 70 trials, at each shock level. We ignore cow differences and differences between blocks (experiments).</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{|c|c|c|c|}
\hline
\text{Current (ma)} &amp; y &amp; \text n &amp; p \\
\hline
0 &amp; 0 &amp; 70 &amp; 0.000 \\
1 &amp; 9 &amp; 70 &amp; 0.129 \\
2 &amp; 21 &amp; 70 &amp; 0.300 \\
3 &amp; 47 &amp; 70 &amp; 0.671 \\
4 &amp; 60 &amp; 70 &amp; 0.857 \\
5 &amp; 63 &amp; 70 &amp; 0.900 \\
\hline
\end{array}
\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(y\)</span> is the number of responses, <span class="math notranslate nohighlight">\(n\)</span> is the number of trials, and <span class="math notranslate nohighlight">\(p\)</span> is the proportion of responses.</p>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/shocks.csv">here</a>.</p>
<p>As in the exercise on beetles (bliss data), model <span class="math notranslate nohighlight">\(y\)</span> as a function of <span class="math notranslate nohighlight">\(x\)</span> via binary regression with 5 different links and propose the link that minimizes the deviance.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="binary-regression-and-iop">
<h2>7. Binary Regression and IOP<a class="headerlink" href="#binary-regression-and-iop" title="Permalink to this headline">#</a></h2>
<p>Laser refractive surgery often decreases Intraocular Pressure (IOP) and may lead to hypotony (clinically significant low IOP that may lead to corneal decompensation, accelerated cataract formation, maculopathy, and discomfort). An investigator wished to determine whether the post-operative IOP in patients after laser refractive surgery was related to the residual thickness of the cornea.</p>
<p>In a sample of 140 patients who had undergone laser surgery, post-operative IOP and the thickness of the cornea were measured. The dataset is provided in the startup file <code class="docutils literal notranslate"><span class="pre">iop2.odc</span></code> which consists of two columns:</p>
<ul class="simple">
<li><p>Indicator of low IOP (IOP &lt; 10)</p></li>
<li><p>Central corneal thickness (in micrometers)</p></li>
</ul>
<ol class="arabic simple">
<li><p>Fit the logistic regression with cornea thickness as the predictor of incidence of low IOP.</p></li>
<li><p>For a person who had a refractive surgery with residual thickness of cornea of 420 micrometers, what is the risk of a low IOP.</p></li>
<li><p>Compare deviances for two links: logit (as in (a)), and probit. Which link provides better fit?</p></li>
</ol>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/iop.csv">here</a>.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="negative-binomial-as-a-gamma-mixture-of-poissons">
<h2>8. Negative Binomial as a Gamma Mixture of Poissons<a class="headerlink" href="#negative-binomial-as-a-gamma-mixture-of-poissons" title="Permalink to this headline">#</a></h2>
<p>Implement this model, which recreates a negative binomial regression as a gamma mixture of Poissons.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
  y_i | \lambda_i &amp;\sim \text{Poisson}(\lambda_i) \\
  \lambda_i | \mu_i, \alpha &amp;\sim \text{Gamma}(\alpha, \frac{\alpha}{\mu_i}) \\
  \mu_i &amp;= \exp(\beta_0 + \beta_1 x_i) \\
  \beta_0 &amp;\sim \mathcal{N}(0, 10^4) \\
  \beta_1 &amp;\sim \mathcal{N}(0, 10^4) \\
  \alpha &amp;\sim \text{Uniform}(0.01, 100)
\end{align*}\]</div>
<p>Here’s the data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">14.2</span><span class="p">,</span> <span class="mf">9.8</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">20.1</span><span class="p">,</span> <span class="mf">18.4</span><span class="p">,</span> <span class="mf">22.7</span><span class="p">,</span> <span class="mf">20.2</span><span class="p">,</span> <span class="mf">21.4</span><span class="p">,</span> <span class="mf">33.0</span><span class="p">,</span> <span class="mf">30.5</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">])</span>
</pre></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
<section id="sex-of-diamond-backed-terrapins-and-incubation-temperature">
<h2>9. Sex of Diamond-backed Terrapins and Incubation Temperature<a class="headerlink" href="#sex-of-diamond-backed-terrapins-and-incubation-temperature" title="Permalink to this headline">#</a></h2>
<p>Temperature-dependent sex determination, observed in some reptiles and fish, is a type of environmental sex determination in which the temperatures experienced during embryonic development determine the sex of the offspring. Data on the relationship between the ratio of male/female diamond-backed terrapins (Malaclemys terrapin) and incubation temperature are reported by Burke and Calichio (2014).</p>
<ol class="arabic simple">
<li><p>Develop a binary regression model for both logit and cloglog links.</p></li>
<li><p>Which link gives smaller deviance?</p></li>
<li><p>Predict the probability of a female terrapin for a temperature of 29°C, using both models.</p></li>
</ol>
<p>Data is available for download in csv format <a class="reference external" href="https://raw.githubusercontent.com/areding/6420-pymc/main/data/terrapins.csv">here</a>.</p>
<p><strong>Reference:</strong>
Burke, R. L. and Calichio, A. M. (2014).<br />
<em>Temperature-dependent sex determination in the diamond-backed terrapin (Malaclemys terrapin)</em>. Journal of Herpetology, 48(4), 466-470.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Solution to be added. Feel free to share yours on Ed Discussion!</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./unit7"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Unit7-demo-multilevel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">19. Paraguay Vaccination Status*</p>
      </div>
    </a>
    <a class="right-next"
       href="../unit8/Unit8-missing.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">1. </span>Missing Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beetles-bliss-data">1. Beetles (Bliss Data)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vasoconstriction">2. Vasoconstriction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caesarean-delivery-categorical-response">3. Caesarean Delivery: Categorical Response</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#magnesium-ammonium-phosphate-and-chrysanthemums">4. Magnesium Ammonium Phosphate and Chrysanthemums</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#third-degree-burns">5. Third-degree Burns</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shocks">6. Shocks!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-regression-and-iop">7. Binary Regression and IOP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#negative-binomial-as-a-gamma-mixture-of-poissons">8. Negative Binomial as a Gamma Mixture of Poissons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sex-of-diamond-backed-terrapins-and-incubation-temperature">9. Sex of Diamond-backed Terrapins and Incubation Temperature</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aaron Reding
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>